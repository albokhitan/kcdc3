{% extends "classes/event_base.html" %}

{% block title %} / Classes and Events{% endblock %}

{% block content %}

	<div id="hed">
		<h1 class="section_hed">Classes + Events</h1>
		<p>As always, KCDC classes are free â€“ and they fill up fast!</p>
	</div>

	<div id="main">
	
		{% for session in selected_session %}
			{% if forloop.last %}
				<div class="local_intro type_section">
					{{ session.description|safe }}
					
					{% if session.documentation %}
						<p class="more_link"><a href="/classes/{{ session.slug }}/background">More about this session</a></p>
					{% endif %}
									
				</div>
			{% endif %}
		{% endfor %}


		<h2 id="upcoming">Upcoming classes</h2>

		<dl class="calendar">

			{% for event in events reversed %}

				{% if not event.has_passed and event.status == "PUBLISHED" %}

					{% ifchanged event.date.toordinal %}
						<dt>
							{{ event.date|date:"l" }}<br />
							<strong>{{ event.date|date:"j" }}</strong> {{ event.date|date:"F" }}
							{% ifchanged event.date.year %}
								<br />{{ event.date|date:"Y" }}
							{% endifchanged %}
						</dt>
					{% endifchanged %}

					<dd>
						<a href="/classes/{{ event.slug }}">
							<h3>
								<!--<b class="event">Event:</b>-->
								{{ event.title }}
							</h3>
							<p class="meta">
								<i class="ss-icon">time</i> {{ event.date|date:"P" }}
							
								{% if event.has_passed %}
									<!-- past event -->
								{% elif event.registration_status == "HIDE" %}
									<!-- hide registration info -->
								{% else %}
									{% if event.registration_status == "AUTO" and not event.is_registration_open %}	
										<!-- registration opens later -->
									{% elif event.registration_status == "PREVENT" %}	
										<span class="registration_indicator"><i class="ss-icon registration_full">&#xF073;</i> Registration is closed</span>			
									{% elif registration_count >=  event.max_students %}
										{% if event.waitlist_status %}
											<span class="registration_indicator"><i class="ss-icon registration_waitlist">&#xF071;</i> Waitlist</span>
										{% else %}
											<span class="registration_indicator"><i class="ss-icon registration_full">&#xF073;</i> Class is full</span>			
										{% endif %}
									{% else%}
										<span class="registration_indicator"><i class="ss-icon registration_open">&#xF070;</i> Registration is open</span>
									{% endif %}
								{% endif %}							
							</p>
							
							{{ event.summary|safe }}

							<p>
								<i class="ss-icon">user</i> Instructor{{ event.num_teachers|pluralize }}: {% for bio in event.teacher_bios.all %}{% if not forloop.first %}, {% endif %}{{ bio.name }}{% endfor %}
							</p>
						</a>
					</dd>




				{% endif %}

			{% endfor %}

		</dl>

		<h2 id="past">Recent classes</h2>

		<dl class="calendar">

			{% for event in events %}

				{% if event.has_passed and event.status == "PUBLISHED" %}

					{% ifchanged event.date.toordinal %}
						<dt>
							{{ event.date|date:"l" }}<br />
							<strong>{{ event.date|date:"j" }}</strong> {{ event.date|date:"F" }}
							{% ifchanged event.date.year %}
								<br />{{ event.date|date:"Y" }}
							{% endifchanged %}
						</dt>
					{% endifchanged %}
					<dd>
						<a href="/classes/{{ event.slug }}">
							<h3>
								<!--<b class="event">Event:</b>-->
								{{ event.title }}
							</h3>
							<p class="meta">
								<i class="ss-icon">time</i> {{ event.date|date:"P" }}
								{% if event.documentation %}
									<span class="registration_indicator documentation"><i class="ss-icon indicator_documentation">&#x1F4F7;</i> Documentation</span>			
								{% endif %}
							</p>
							{{ event.summary|safe }}
							<p>
								<i class="ss-icon">user</i> Instructor{{ event.num_teachers|pluralize }}: {% for bio in event.teacher_bios.all %}{% if not forloop.first %}, {% endif %}{{ bio.name }}{% endfor %}
								{% if event.teacher_text %}{{ event.teacher_text|safe }}{% endif %}
							</p>
						</a>
					</dd>

				{% endif %}

			{% endfor %}

		</dl>

	</div>

{% endblock %}




{% block sidebar_content %}

		<div class="sidebar_text sidebar_contrast">

			{% for session in selected_session %}
				{{ session.sidebar_text|safe }}
			{% endfor %}

		</div>

{% endblock %}
