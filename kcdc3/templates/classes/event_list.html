{% extends "base.html" %}

{% block title %}Classes and Events{% endblock %}

{% block content %}

	<h1>Classes and Events</h1>

	<section>

		<p class="intro">As always, KCDC classes are <strong>free</strong> &ndash; and they fill up fast!</p>

		<p>
			Classes Jan. 1&ndash;6 will open for registration on Dec. 20 at noon.
		</p>

		<p>
			Registration for the remaining weeks begins on Fridays at noon:<br />
			Classes Jan. 7&ndash;13 open Dec 31<br />			
			Classes Jan. 14&ndash;20 open Jan. 7<br />			
			Classes Jan. 21&ndash;27 open Jan. 14<br />			
			Classes Jan. 28&ndash;31 open Jan. 21
		</p>

		<!--
		<p class="intro2">Course evaluations help us improve KCDC. Please <a href="https://docs.google.com/spreadsheet/viewform?formkey=dEdzZ3pJT1FLd0MtSWlTcmRTRkphUlE6MQ">fill out a course evaluation</a> once you&#8217;ve taken the class.</p>
		-->
	
	</section>

	{% comment %} TODO: We should not be duplicating the markup and template tags, and we should be filtering in the view. {% endcomment %}

	<h2 id="upcoming">Upcoming classes</h2>

	<dl class="date-listing">

		{% for event in event_list reversed %}

			{% if not event.has_passed and event.status == "PUBLISHED" %}

				{% ifchanged %}
					<dt>
						{{ event.date|date:"l" }}<br />
						<strong>{{ event.date|date:"j" }}</strong> {{ event.date|date:"F" }}
						{% if forloop.first %}
							{{ event.date|date:"Y" }}
						{% endif %}
					</dt>
				{% endifchanged %}
				<dd>
				<h3>
					<!--<b class="event">Event:</b>-->
					<a href="/classes/{{ event.slug }}">{{ event.title }} <span class="meta">({{ event.date|date:"P" }})</span></a>
				</h3>

				{{ event.summary|safe }}

				<p>Instructor{{ event.num_teachers|pluralize }}: {% for bio in event.teacher_bios.all %}{% if not forloop.first %}, {% endif %}{{ bio.name }}{% endfor %}</p>

				{% if not event.has_passed and event.registration_status == "ALLOW" %}	
					{% if event.registration_count >= event.max_students %}
					 	{% if event.waitlist_status %}
							<p><em>waitlist available</em></p>
						{% else %}
							<p><em>class is full</em></p>			
						{% endif %}
					{% else %}
						<p><em>registration is open</em></p>
					{% endif %}
				{% endif %}

				</dd>

			{% endif %}

		{% endfor %}

	</dl>
	<div class="clear"></div>
	
	

	<h2 id="past" style="padding-top: 3em;">Recent classes</h2>

	<dl class="date-listing">

		{% for event in event_list %}

			{% if event.has_passed and event.status == "PUBLISHED" %}

				{% ifchanged %}
					<dt>
						{{ event.date|date:"l" }}<br />
						<strong>{{ event.date|date:"j" }}</strong> {{ event.date|date:"F" }}
						{% if forloop.first %}
							{{ event.date|date:"Y" }}
						{% endif %}
					</dt>
				{% endifchanged %}
				<dd>
				<h3>
					<!--<b class="event">Event:</b>-->
					<a href="/classes/{{ event.slug }}">{{ event.title }} <span class="meta">({{ event.date|date:"P" }})</span></a>
				</h3>

				{{ event.summary|safe }}

				<p>Instructor{{ event.num_teachers|pluralize }}: {% for bio in event.teacher_bios.all %}{% if not forloop.first %}, {% endif %}{{ bio.name }}{% endfor %}</p>

				</dd>

			{% endif %}

		{% endfor %}

	</dl>


	
{% endblock %}